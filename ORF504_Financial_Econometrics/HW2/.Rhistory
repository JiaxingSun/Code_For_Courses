Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Plot(Sdate,cp,type="l")
plot(Sdate,cp,type="l")
plot(Sdate,mm,type="l")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Time<-length(cp)
tt<-rep(0,Time)
ss<-50
for(i in ss:Time)
{
x=mm[1:i]
y<-rep(0,i)
y[1:i-1]<-x[2:i]
x1<-sum(x[1:i-1])
mm<-rep(0,Time)
mm[1]=0
for (g in 2:Time)
mm[g]<-log(cp[g]/cp[g-1])}
plot(seq(1,Time,1),mm,type="l")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Time<-length(cp)
tt<-rep(0,Time)
ss<-50
for(i in ss:Time)
{
x=mm[1:i]
y<-rep(0,i)
y[1:i-1]<-x[2:i]
x1<-sum(x[1:i-1])
mm<-rep(0,Time)
mm[1]=0
for (g in 2:Time)
mm[g]<-log(cp[g]/cp[g-1])}
plot(seq(1,Time,1),mm,type="l")
tt<-rep(0,Time)
ss<-50
for(h in ss:Time)
{
x=mm[1:h]
y<-rep(0,h)
y[1:(h-1)]<-x[2:h]
x1=sum(x[2:h])/(h-1)
x2=sum(x[1:h-1])/(h-1)
sss<-(y-x1)*(x-x2)
ttt<-(x-x2)^2
r<-sum(sss[1:h-1])/sum(ttt[1:h-1])
tt[h]<-h*(r-1)
}
plot(seq(50,Time,1),tt[50:T],type="l")
}
plot(tt[50:T],type="l")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Time<-length(cp)
tt<-rep(0,Time)
ss<-50
for(i in ss:Time)
{
x=mm[1:i]
y<-rep(0,i)
y[1:i-1]<-x[2:i]
x1<-sum(x[1:i-1])
mm<-rep(0,Time)
mm[1]=0
for (g in 2:Time)
mm[g]<-log(cp[g]/cp[g-1])}
plot(seq(1,Time,1),mm,type="l")
tt<-rep(0,Time)
ss<-50
for(h in ss:Time)
{
x=mm[1:h]
y<-rep(0,h)
y[1:(h-1)]<-x[2:h]
x1=sum(x[2:h])/(h-1)
x2=sum(x[1:h-1])/(h-1)
sss<-(y-x1)*(x-x2)
ttt<-(x-x2)^2
r<-sum(sss[1:h-1])/sum(ttt[1:h-1])
tt[h]<-h*(r-1)
}
plot(tt[50:Time]~seq[50,Time,1],type="l")
plot(tt[50:Time]~seq[50,Time,1])
plot(tt[50:Time]~seq[50,Time,1])
plot(tt[50:Time]~seq[50,Time,1])
plot(tt[50:Time]~seq[50,Time,1])
plot(seq[50,Time,1],tt[50:Time])
plot(seq[50,Time,1],tt[50:Time])
tt
plot(seq[50,Time,1],tt[50:Time])
xxxx<-rep(1,Time-49)
plot(xxxx,tt[50:Time])
tt
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Time<-length(cp)
tt<-rep(0,Time)
ss<-50
for(i in ss:Time)
{
x=mm[1:i]
y<-rep(0,i)
y[1:i-1]<-x[2:i]
x1<-sum(x[1:i-1])
mm<-rep(0,Time)
mm[1]=0
for (g in 2:Time)
mm[g]<-cp[g]/cp[g-1]}
plot(seq(1,Time,1),mm,type="l")
tt<-rep(0,Time)
ss<-50
for(h in 50:Time)
{
x=mm[1:h]
y<-rep(0,h)
y[1:(h-1)]<-x[2:h]
x1=sum(x[2:h])/(h-1)
x2=sum(x[1:h-1])/(h-1)
sss<-(y-x1)*(x-x2)
ttt<-(x-x2)^2
r<-sum(sss[1:h-1])/sum(ttt[1:h-1])
tt[h]<-h*(r-1)
}
tt
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
mm<-rep(0,length(cp))
mm[1]<-0
for(j in 2:length(cp))
mm[j]<-log(cp[j])
plot(Sdate,mm,type="l")
Time<-length(cp)
tt<-rep(0,Time)
ss<-50
for(i in ss:Time)
{
x=mm[1:i]
y<-rep(0,i)
y[1:i-1]<-x[2:i]
x1<-sum(x[1:i-1])
mm<-rep(0,Time)
mm[1]=0
for (g in 2:Time)
mm[g]<-log(cp[g]/cp[g-1])}
plot(seq(1,Time,1),mm,type="l")
tt<-rep(0,Time)
ss<-50
for(h in 50:Time)
{
x=rep(0,h)
x=log(cp)
y<-rep(0,h)
y[1:(h-1)]<-x[2:h]
x1=sum(x[2:h])/(h-1)
x2=sum(x[1:h-1])/(h-1)
sss<-(y-x1)*(x-x2)
ttt<-(x-x2)^2
r<-sum(sss[1:h-1])/sum(ttt[1:h-1])
tt[h]<-h*(r-1)
}
tt
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
logprice<-log(cp)
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
ttest
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
Sdate<-as.Date(Temp$Date)
cp<-Temp[,7]
logprice<-log(cp)
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
ttest
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
logprice<-log(cp)
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
ttest
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
logprice<-log(cp)
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
ttest
plot(seq(50,L,1),ttest[50,L])
plot(seq(50,L,1),ttest[50:L])
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
cpr<-rep(0,L)
for(i in 1:L)
{
cpr[i]<-cp[L+1-i]
}
logprice<-log(cpr)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
plot(seq(50,L,1),ttest[50:L])
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
cpr<-rep(0,L)
for(i in 1:L)
{
cpr[i]<-cp[L+1-i]
}
logprice<-log(cpr)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
plot(seq(50,L,1),ttest[50:L],type="l")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
cpr<-rep(0,L)
for(i in 1:L)
{
cpr[i]<-cp[L+1-i]
}
logprice<-log(cpr)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
plot(seq(50,L,1),ttest[50:L],type="l",xlab="Time",ylab="T-test")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("Intelmonthly.csv",header=TRUE)
cp<-Temp[,7]
L<-length(cp)
ttest<-rep(0,L)
row<-rep(0,L)
cpr<-rep(0,L)
for(i in 1:L)
{
cpr[i]<-cp[L+1-i]
}
logprice<-log(cpr)
for (i in 50:L)
{
xmean2<-sum(logprice[2:i])/(i-1)
xmean1<-sum(logprice[1:i-1])/(i-1)
row[i]<-sum((logprice[2:i]-xmean2)* (logprice[1:(i-1)]-xmean1))/sum((logprice[1:i-1]-xmean1)^2)
ttest[i]<-i*(row[i]-1)
}
plot(seq(50,L,1),ttest[50:L],type="l",xlab="Time",ylab="T-test",main="Bubble or not?")
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("mrk.csv",header=TRUE)
cp<-Temp[,7]
L=length(cp)
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("mrk.csv",header=TRUE)
cp<-Temp[,7]
L=length(cp)
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("mrk.csv",header=TRUE)
cp<-Temp[,7]
L=length(cp)
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
?floor
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("MerckDaily.csv",header=TRUE)
cp1<-Temp[,7]
L1=length(cp1)
L=floor(L1/21)
cp<-rep(0,L)
for(i in 1:L)
cp[i]=cp1[21*(i-1)+1]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("MerckDaily.csv",header=TRUE)
cp2<-Temp[,7]
L1=length(cp2)
cp1<-rep(0,L1)
for(i in 1:L1)
cp1[i]<-cp2[L1+1-i]
L=floor(L1/21)
cp<-rep(0,L)
for(i in 1:L)
cp[i]=cp1[21*(i-1)+1]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("mrk.csv",header=TRUE)
cp1<-Temp[,7]
L=length(cp1)
cp<-rep(0,L)
for(i in 1:L)
cp[i]<-cp1[L+1-i]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("mrk.csv",header=TRUE)
cp1<-Temp[,7]
L=length(cp1)
cp<-rep(0,L)
for(i in 1:L)
cp[i]<-cp1[L+1-i]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("MerckDaily.csv",header=TRUE)
cp2<-Temp[,7]
L1=length(cp2)
cp1<-rep(0,L1)
for(i in 1:L1)
cp1[i]<-cp2[L1+1-i]
L=floor(L1/21)
cp<-rep(0,L)
for(i in 1:L)
cp[i]=cp1[21*(i-1)+1]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
logprice<-log(cp)
logreturn<-rep(0,L)
for(i in 2:L)
logreturn[i]=logprice[i]-logprice[i-1]
Box.test(logreturn,lag=5,type="Ljung-Box")
Box.test(logreturn,lag=5,type="Ljung-Box")
logprice<-log(cp)
logreturn<-rep(0,L)
for(i in 2:L)
logreturn[i]=logprice[i]-logprice[i-1]
Box.test(logreturn,lag=5,type="Ljung-Box")
Box.test(logreturn,lag=10,type="Ljung-Box")
arima(logreturn,order=c(1,0,0))
arima(logreturn,order=c(1,0,0))
answer<-arima(logreturn,order=c(0,0,1))$residuals
Box.test(answer,lag=1,type="Ljung-Box")
Box.test(answer,lag=5,type="Ljung-Box")
Box.test(answer,lag=10,type="Ljung-Box")
arima(logreturn,order=c(1,0,0))
arima(logreturn,order=c(1,0,1))
arima(logreturn,order=c(0,0,1))
arima(logreturn,order=c(2,0,0))
arima(logreturn,order=c(0,0,2))
logprice<-log(cp)
logreturn<-rep(0,L)
for(i in 2:L)
logreturn[i]=logprice[i]-logprice[i-1]
Box.test(logreturn,lag=5,type="Ljung-Box")
Box.test(logreturn,lag=10,type="Ljung-Box")
######Q7a#########
setwd("C:/Courses/ORF504Financial Econometrics/HW2")
Temp=read.csv("MerckDaily.csv",header=TRUE)
cp2<-Temp[,7]
L1=length(cp2)
cp1<-rep(0,L1)
for(i in 1:L1)
cp1[i]<-cp2[L1+1-i]
L=floor(L1/21)
cp<-rep(0,L)
for(i in 1:L)
cp[i]=cp1[21*(i-1)+1]
row=sum(cp[2:L]*cp[1:L-1])/sum(cp[1:L-1]^2)
xmean2=sum(cp[2:L])/(L-1)
xmean1=sum(cp[1:L-1])/(L-1)
rowd=sum((cp[2:L]-xmean2)*(cp[1:L-1]-xmean1))/sum((cp[1:L-1]-xmean1)^2)
test=(row-1)*L
testd=(rowd-1)*L
test
testd
